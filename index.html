<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Snowball Practice</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<style type="text/css">
body {
  background: #fff;
}

#game {
  background: linear-gradient(#1e5a97, #62a7ee, #1e5a97);
  
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  
}
</style>
<script>
var player = {};

player.avatar="snowman.png";
player.x=0;
player.y=0;
player.width=30;
player.height=30;

var Snowball = {};

Snowball.x=0;
Snowball.y=0;
Snowball.width=10;
Snowball.height=10;

var request_frame = (function(callback)
{
  return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function(callback){window.setTimeout(callback, 1000 / 60)};
})();

var canvas, context;
var started = false;
var paused=false;
var fired=[];

$(document).ready(function(){

  canvas = $("#game")[0];
  context = canvas.getContext('2d');
  
  // game intro instructions
  context.clearRect(0, 0, canvas.width, canvas.height);
  context.font = '18pt Calibri';
  context.fillStyle = '#fff';
  context.textAlign = 'center';
  context.fillText("Press ENTER to start game", canvas.width / 2, 50);
  context.fillText("Use LEFT and RIGHT arrow keys to move player", canvas.width / 2, 200);
  context.fillText("Use SPACEBAR to fire at targets", canvas.width / 2, 250);
  
  $(document).keypress(function(e){
    // start game if user presses enter
    if(e.keyCode==13){
      context.clearRect(0, 0, canvas.width, canvas.height);
      started=true;
      animate();
    }
    else if(e.keyCode==32){
      var shot = Object.create(Snowball);
      // align shot with center of player
      shot.x = player.x + player.width/2 - shot.width/2;
      // start shot at tip of player
      shot.y = player.y - shot.height;
      fired.push(shot);
    }
    else if(e.code=="KeyP"){
      paused=!paused;
      if(!paused)
        animate();
    }
  });

});

function movePlayer(e)
{
if(!started)
  return;
var rect = canvas.getBoundingClientRect();
var message = (e.clientX - rect.left) + ", " + (e.clientY - rect.top);
context.clearRect(0, 0, canvas.width, canvas.height);
context.textAlign = 'left';
context.fillText(message, 10, 25);
}


var x_max = false;
var y_max = false;
function animate()
{

context.fillStyle = "rgba(255, 255, 255, 0.5)";
context.strokeStyle = "#000";
context.lineWidth=2;

if(paused) {
  context.fillStyle = 'rgba(255, 255, 255, 0.5)';
  context.fillRect(0, canvas.height / 2 - 25, canvas.width, 50);
  context.font = '28pt Calibri';
  context.fillStyle = '#000';
  context.textAlign = 'center';
  context.textBaseline = "middle"; 
  context.fillText("PAUSED", canvas.width / 2, canvas.height / 2);
  return;
}

context.clearRect(0, 0, canvas.width, canvas.height);


if((player.x + player.width) > canvas.width)
  x_max = true;
else if(player.x < 0)
  x_max = false;

if((player.y + player.height) > canvas.height)
  y_max = true;
else if(player.y < 0)
  y_max = false;

if(x_max)
  player.x -= 3;
else
  player.x += 3;

if(y_max)
  player.y -= 3;
else
  player.y += 3;

//player.y=700;

context.beginPath();
context.arc(player.x, player.y, player.width, 0 , 2 * Math.PI);
context.fill();
context.stroke();

//context.fillRect(player.x, player.y, player.width, player.height);

//context.fillRect(player.x + 20, player.y, player.width, player.height);
//context.fillRect(player.x, player.y + 20, player.width, player.height);
//context.fillRect(player.x + 20, player.y + 20, player.width, player.height);

var shot_count = fired.length;

if(shot_count)
{

  for(var i = 0; i < shot_count; i++)
  {
    
    var shot = fired[i]
    
    shot.y -= 1;
    //context.beginPath();
    context.arc(shot.x, shot.y, shot.width, 0 , 2 * Math.PI);
    context.fill();
    context.stroke();
    //context.fillRect(shot.x, shot.y, shot.width, shot.height);
    if((shot.y + shot.height) <= 0)
    {
      // remove element from fired array if it goes off screen
      fired.splice(i, 1);
      i--;
      shot_count--;
    }
    
    document.title=shot_count;
  
  }
  //snowball.y -= 3;
  //if(snowball.y <= 0)
    //fired=false;
}

request_frame(function() {
  animate();
});

}
</script>
</head>

<body>

<canvas id="game" onmousemove="return;movePlayer(event)" width=1000 height=700></canvas>


</body>
</html>